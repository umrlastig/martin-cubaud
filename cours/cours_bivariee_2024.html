<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<title>Analyse Bivariée</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/white.css">
		<link rel="stylesheet" href="plugin/tabs/tabs.css">
		<link rel="icon" type="image/png" href="logo_ENSG.png" />
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<style>
		.top_bar {
			width: 100%;
			background-color: #97bf11;
			top: 0px;
			font-size: 35px;
		}
		
		p, a {
			font-size: 30px;
		}
		li {
			font-size: 30px;
		}
		code{
			font-size: 15px;
			line-height: 1.2em;
			max-height: 30%;
		}
		section {
			height: 100%;
		}
		b, strong {
		color: #7a9e08;
		}
		i {
		font-style: italic;
		}
		.tabs {
		margin: 0px;
		display: flex;
		}
		.tab-button {
		padding: 10px 20px;
		border-radius: 10px 10px 0px 0px;
		cursor: pointer;
		background-color: #ddd;
		border: none;
		outline: none;
		}
		.tab-button:hover{
			padding: 9px 19px;
			border: 1px solid black;
		}
		.tab-button.active {
		background-color: #666;
		color: white;
		}
		.tab-content.inactive{
		display: none;
		visibility: hidden;
		height: 0px;
		margin: 0px;
		}
		.tab-content.active {
		display: block;
		visibility: visible;
		height: fit-content;
		margin: 0px;
		}
		.img.active{
			visibility: visible;
			margin: 0px;
			max-height: 50%;
			height: auto;
		}
		.img.inactive{
			visibility: hidden;
			margin: 0px;
			height: 0px;
		}
		.text.active{
			visibility: visible;
			font-size: 30px;
			margin: 20px 0px;
		}
		.text.inactive{
			visibility: hidden;
			color:white;
			font-size: 1px;
			margin: 0px 0px;
		}

		.dataframe.active{
			font-size: 20px;
			visibility: visible;
			margin: 20px;
		}
		.dataframe.inactive{
			font-size: 0px;
			visibility: hidden;
			margin: 8px;
		}

		.tr1{
			background-color: #272822;
			color: #c3c3c3;
		}
		.tr2{
			background-color: #454545;
			color: #c3c3c3;
		}

		.head.text.active{
			font-size: inherit;
		}
		.answer{
			background-color: #454545;
		}

		.hljs-comment{
			color: wheat;
		}
	</style>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
						<h2>Analyse Bivariée</h2>
						<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						<h4>M2 IGAST</h4>
						<div>
							<small>
							<p>Martin Cubaud</p>
							<p>LASTIG-UGE-IGN/ENSG</p>
							<p>2024-2025</p>
							</small>
						</div>
						<img src="logo_ENSG.png" alt="reveal.js logo" style="height: 100px; margin: 0 auto 4rem auto; background: transparent; position: absolute;top: 0px;right: 0px;" class="demo-logo">
					</div>
				</section>

				<section>
					<section>
						<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
							<h4>Introduction et rappels</h4>
							<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Sources et références</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<ul>
								<li>Ce cours reprend le cheminement des cours M2 IGAST 2020 de Paul Chapron et 2017 d’Élodie Buard</li>
								<li>Probabilités, analyse de données et statistiques , Gilbert Saporta, Editions TECHNIP, 2011</li>
								<li>Nombreuses ressources en ligne : <a href="http://www.foad-mooc.auf.org/IMG/pdf/424B_-Application_des_methodes_statistiques_d_analyse.pdf">http://www.foad-mooc.auf.org/IMG/pdf/424B_-Application_des_methodes_statistiques_d_analyse.pdf</a></li>
								<li>et wikipedia !</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Rappel : Deux familles statistiques</h4>
						<h4>statistiques <b>inférentielles</b></h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Pour répondre à la question : «A partir d’un échantillon , que peut-on attendre (inférer) de la population ?» </p>
							<ul>
								<li>Modèles, estimateurs… : <b>régression</b>, <b>estimation</b>, <b>extrapolation</b></li>
								<li><i>Liaisons</i> statistiques : <b>corrélation</b>, <b>covariance</b></li>
								<li>test statistiques, notions de probabilités</li>
								<li>e.g. sondages, rencensement, intervalle de confiance , prédictions…</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Rappel : Deux familles statistiques</h4>
						<h4>statistiques <b>descriptives</b></h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>
								Pour <b>résumer</b>, <b>synthétiser</b>, rendre intelligible, les propriétés d’une <b>population</b> à partir des <b>variables</b> qui décrivent les individus et la <b>répartition</b> de leurs valeurs. </p>
							<ul>
								<li>Graphiques (histogrammes, boxplots…)</li>
								<li>Mesures (fréquences, distributions, moments…)</li>
								<li>classification, ACP…</li>
								
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Rappel : vocabulaire</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p><b>Population</b> : Ensemble d'individus</p>
							<p>“données”, “corpus”, “échantillon”, “data”</p>
							<p><b>Individu</b> : Unité statistique <b>élémentaire</b> = «les lignes du tableau»</p>
							<p><b>Variables</b> : Caractéristiques, propriétés d’un individu, <b>mesurées</b> par des enquêtes, des observations… = «les colonnes du tableau»</p>
						</div>
					</section>

					<section>
						<h4 class="top_bar">L’objet du cours : l’ Analyse Bivariée</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Objectif : <b>Analyser</b> le <b>lien</b> entre deux variables, par exemple :</p>
							<p><b>lien entre deux variables quantitatives</b></p>
							<p style="font-size: 20px;">“nombre d’habitants et nombre de lignes de bus par département”</p>
							<p style="font-size: 20px;">“nombre de lignes de bus en 1998 et en 2018”</p>
							<p><b>lien entre deux variables qualitatives</b></p>
							<p style="font-size: 20px;">“couleur des yeux et port de lunettes”</p>
							<p><b>lien entre une variable quantitative, une variable qualitative</b></p>
							<p style="font-size: 20px;">“taille et couleur des yeux”</p>
						</div>
					</section>
					
					<section>
						<h4 class="top_bar">Mise en garde</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p><span style="color: red;">⚠ Une liaison, même très forte, entre deux variables, n’indique pas la causalité! ⚠</span><br>
							Erreur très courrante, très tentante.</p>
							<img src="img/images_bivariees/chart.svg" style="width: 100%;">
							<p>© TylerVigen <a href="http://tylervigen.com/spurious-correlations">http://tylervigen.com/spurious-correlations</a></p>
						</div>
					</section>

					<section>
						<h4 class="top_bar">Analyse bivariée avec des données spatiales</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<h4>Données spatiales</h4>
							<ul>
								<li>Individus restreints spatialement (selection spatiale)</li>
								<li>variables “géographique” (e.g. lieu de résidence) renseignées pour les individus</li>
							</ul>
							<p>prise en compte des <b>distances</b> ? → modèle gravitaire</p>
							<h4>Données localisées</h4>
							<ul>
								<li>Auto-corrélation spatiale (Moran’s I)</li>
								<li>Geographicaly Weighted Regression (GWR) ≈ regression linéaire avec prise en compte de la distance entre individus</li>
							</ul>
						</div>
					</section>
				</section>
				<section>
					<section>
						<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
							<h4>Régression linéaire</h4>
							<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Première étape</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p><span style="color:red;">Toujours en premier :</span> regarder l'aspect des données avec des graphiques (exploration visuelle)</p>
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">from sklearn.datasets import load_iris
iris = load_iris()
df = pd.DataFrame(iris.data, columns=iris.feature_names)
pd.plotting.scatter_matrix(df, figsize=[20, 10], s=150)</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">data(iris)
plot(iris)</code></pre>
							<img class="numpy img active" style="align-self: center;" src="img/images_bivariees/plotIris-1_python.png">
							<img class="r img inactive" style="align-self: center;" src="img/images_bivariees/plotIris-1.png">
						
							<p>Existe-t-il un lien entre les variables ?</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">différentes formes de relations entre variables</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<img style="align-self: center; width:80%;" src="img/images_bivariees/formes-1.png">
							<p>En pratique, les formes sont beaucoup moins régulières.</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Les étapes</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<ol>
								<li>Tracer le nuage de points</li>
								<li>Existe-t-il une relation ?</li>
								<li>Est-elle de forme linéaire ? De quel sens ?</li>
								<li>Si la liaison est de forme linéaire → faire une <b>régression</b></li>
								<li>Si la liaison est non linéaire, est-elle <b>monotone</b> ? De forme connue ?→ Proposer un <b>modèle</b></li>
							</ol>
							<p>5bis. Réaliser un modèle <b>LOESS</b> avec prudence (uniquement descriptif , aucun pouvoir de généralisation)</p>
							<p>cf le blog de Lise Vaudor [<a href="http://perso.ens-lyon.fr/lise.vaudor/regression-loess/" class="uri">http://perso.ens-lyon.fr/lise.vaudor/regression-loess/</a>]</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Régression linéaire</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">						
							<p>Si la forme du nuage de points s’y prête, on peut faire une <b>régression linéaire</b> (aussi appelé <b>ajustement</b> linéaire).</p>
							<p>On cherche la droite qui «passe au mieux» (=<em>ajustée</em>) dans le nuage de points de deux variables quantitatives $V_1$ et $V_2$, qui permet de visualiser :</p>
								<li>l’<b>intensité</b> du lien / de la dépendance : points proche de la droite ou non ?</li>
								<li>la <b>forme</b> de la dépendance : linéaire ou non ?</li>
								<li>le <b>sens</b> de la dépendance : nulle, positive ou négative ?</li>
							</ul>

						</div>
					</section>
					<section>
						<h4 class="top_bar">Régression linéaire</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<img style="align-self: center; width:80%;" src="img/images_bivariees/regline-1.png">
							<p>«Droite qui passe au mieux» = qui minimise <b>la somme des écarts quadratiques</b> entre la droite et les points du nuage.</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Régression linéaire : le modèle</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>L’<b>équation</b> de la droite est un <b>modèle linéaire</b> de la relation statistique qui lie $V_1$ et $V_2$;</p>
							<p>Ici le modèle est : $\hat{V}_2 = a V_1 + b$</p>
							<p>$a$ et $b$ sont les <b>paramètres</b> ou <b>coefficients</b> du modèle.<br></p>
							<p>Si la régression linéaire est avérée, alors pour un individu $i$ dont on connait $V_{1}i$, on infère la valeur $V_{2}i$ par le modèle : $\hat{V}_2i=a V_1i+b$</p>
							<p>On dit aussi que $V_1$ <b>explique</b> $V_2$, ou que le modèle <b>prédit</b> $V_2$ à partir de $V_1$ (on note les valeurs prédites $\hat{V}_2$)</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">La grande question</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:center; text-align: justify;">
							<p style="font-size: 40px;">Comment déterminer qu’une régression linéaire est «correcte» ?</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Comment evaluer la “validité” du modèle linaire ?</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>En pratique, il faut réunir deux critères :</p>
							<ul>
								<li>des coefficients avec des <b>p-values</b> associées <b>faibles</b> (e.g. <0.05) ↔ “on a peu de chances de se tromper”</li>
								<li>un $R²$ <b>élevé</b> ↔ “le modèle prédit bien les observations”</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Le $R²$</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>$R^2 \in [0, 1]$ est le <b> coefficient de détermination linéaire</b>.</p>
							<p>Donne la <b>qualité de prédiction</b> de la régression.</p>
							<p>“Proche de 1”" ≡ “très bonne qualité”</p>
							<p>C’est le pourcentage de “variation” de $V_2$ due à la “variation” de $V_1$</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Le $R²$</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Défini par $R^2 = 1-\dfrac{\sum_{i=1}^n\left(y_i-\hat{y_i}\right)^2}{\sum_{i=1}^n\left(y_i-\bar y\right)^2} $</p>

							<p>si on note $\hat{V}_2$ les valeurs de $V_2$ prédites par le modèle linéaire, alors :</p>
							<p>$R^2 = cor(V_2, \hat{V}_2)^2$</p>
							<p>(au sens de la corrélation de Pearson)</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">La p-value</h4>
						<div style="width:100%; height:70%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Elle peut s’interpréter comme «la probabilité d’avoir un résultat de regression identique avec deux variables véritablement indépendantes»</p>
							<p><br></p>
							<p>La p-value est associée à la notion d’<b>hypothèses nulle</b>. Ici , l’hypothèse nulle est “les deux séries sont indépendantes”.</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">La p-value</h4>
						<div style="width:100%; height:70%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Plus grossièrement : la p-value est le <b>pourcentage de chances de se tromper</b> en rejetant l’hypothèse nulle,</p>
							<p><br></p>
							<p>c'est-à-dire<br>se tromper en considérant que les deux séries ne sont pas indépendantes et qu’il existe une relation entre les deux (ici, linéaire car nous testons un modèle linéaire).</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">L'hypothèse nulle</h4>
						<div style="width:100%; height:50%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>$H_0$ : «les deux variables sont indépendantes»</p>
							<ul>
								<li><b>conserver</b> $H_0$ : considérer les deux variables comme <b>indépendantes</b></li>
								<li><b>rejeter</b> $H_0$ : considérer les deux variables comme <b>dépendantes</b> = ayant une relation statistique, un lien.</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Format des resultats donnés par <span class="numpy text head active">scipy</span><span class="r text head inactive">R</span></h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">from scipy.stats import linregress
linregress(df['petal length (cm)'], df['petal width (cm)'])</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">regression <- lm(iris$Petal.Length~iris$Petal.Width)
summary(regression)</code></pre>

							<p></p>
							<pre class="numpy tab-content active"><code class="answer">LinregressResult(
	slope=0.41575541635241114, intercept=-0.36307552131902776,
	rvalue=0.9628654314027963, pvalue=4.6750039073255014e-86,
	stderr=0.009582435790766206, intercept_stderr=0.03976198987309611
	)</code></pre>
							<pre class="r tab-content inactive"><code class="answer">## 
## Call:
## lm(formula = iris$Petal.Length ~ iris$Petal.Width)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.33542 -0.30347 -0.02955  0.25776  1.39453 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       1.08356    0.07297   14.85   <2e-16 ***
## iris$Petal.Width  2.22994    0.05140   43.39   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.4782 on 148 degrees of freedom
## Multiple R-squared:  0.9271, Adjusted R-squared:  0.9266 
## F-statistic:  1882 on 1 and 148 DF,  p-value: < 2.2e-16</code></pre>
						
						<p class="numpy text active">Coefficients du modèle ajusté, R (et non R²), la p-value, écart-type des erreurs sur les coefficients.</p>
						<p class="r text inactive">Distribution des résidus, coefficients du modèle ajusté et leur p-value associée (ici sur un test de Student, notée Pr(>|t|) et R2)</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Bonus: Critères de significativité du lien linéaire</h4>
						<div style="width:100%; height:50%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Les <b>résidus</b> $\epsilon_i$ (écart entre valeur observée et valeur prédite $(V_2−\hat{V}_2)$ par le modèle pour l’individu i) doivent:</p>
							<ul>
								<li>être indépendants : covariance nulle ou très faible<br>$cov(x_i,\epsilon_i)=0$</li>
								<li>être distribués selon un loi normale de moyenne nulle <br>$\epsilon  \sim \mathcal{N}(0,\sigma_{\epsilon})$</li>
								<li>être distribués de façon homogène (homoscédasticité), i.e. de variance constante $var(\epsilon_i)=\sigma^2_\epsilon$ , indépendante de l’observation.</li>
							</ul>
						</div>	
					</section>
					<section>
						<h4 class="top_bar">Bonus : évaluation de l'indépendance des résidus avec <span class="numpy text head active">statsmodels</span><span class="r text head inactive">R</span></h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							
						
							<p class="numpy text active">Graphique de la fonction <i>plot_acf</i> :<br>Si une barre (exceptée la première) dépasse la zone bleutée, on peut remettre en cause l’indépendance des résidus. Ici, c’est le cas.</p>
							<p class="r text inactive">Graphique de la fonction <i>acf</i> :<br>Si une barre (exceptée la première) dépasse la ligne en pointillés, on peut remettre en cause l’indépendance des résidus. Ici, c’est le cas.</p>
							
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">import statsmodels.api as sm
import matplotlib.pyplot as plt
reg = linregress(df['petal length (cm)'], df['petal width (cm)'])
residuals = df['petal width (cm)'] - ( reg.intercept + reg.slope * df['petal length (cm)'] )
sm.graphics.tsa.plot_acf(residuals, lags=20)
plt.show()</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">modele1 <- lm(iris$Petal.Length~ iris$Petal.Width)
acf(residuals(modele1))</code></pre>

							<img class="numpy img active" style="align-self: center;" src="img/images_bivariees/residualSigni3-1_python.png">
							<img class="r img inactive" style="align-self: center;" src="img/images_bivariees/residualSigni3-1.png">
						
						</div>
					</section>
					<section>
						<h4 class="top_bar">Bonus : Évaluer l’homogénéité des résidus avec <span class="numpy text head active">statsmodels</span><span class="r text head inactive">R</span></h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							
						
							<p class="numpy text active">Graphique de la fonction <i>plot_acf</i> :<br>Si une barre (exceptée la première) dépasse la zone bleutée, on peut remettre en cause l’indépendance des résidus. Ici, c’est le cas.</p>
							<p class="r text inactive">Graphique de la fonction <i>acf</i> :<br>Si une barre (exceptée la première) dépasse la ligne en pointillés, on peut remettre en cause l’indépendance des résidus. Ici, c’est le cas.</p>
							
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">import statsmodels.api as sm
import matplotlib.pyplot as plt
reg = linregress(df['petal length (cm)'], df['petal width (cm)'])
residuals = df['petal width (cm)'] - ( reg.intercept + reg.slope * df['petal length (cm)'] )
sm.graphics.tsa.plot_acf(residuals, lags=20)
plt.show()</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">modele1 <- lm(iris$Petal.Length~ iris$Petal.Width)
acf(residuals(modele1))</code></pre>

							<img class="numpy img active" style="align-self: center;" src="img/images_bivariees/residualSigni3-1_python.png">
							<img class="r img inactive" style="align-self: center;" src="img/images_bivariees/residualSigni3-1.png">
						
						</div>
					</section>
				</section>


				<section>
					<section>
						<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
							<h4>Corrélation de deux variables quantitatives</h4>
							<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Corrélation (linéaire)</h4>
						<div style="width:100%; height:50%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Dans le cas d’une liaison statistique linéaire entre deux variables, on peut calculer l’«intensité» de ce lien sans nécessairement trouver les coefficients modèle linéaire : c’est la <b>corrélation</b></p>
							<p>$cor(x, y) \in [-1; 1]$ entre deux variables $x$ et $y$</p>
							<ul>
								<li>+1 : les deux variables croissent ou décroissent conjointement</li>
								<li>-1 : quand l’une des variables croît, l’autre décroît.</li>
								<li>0 : pas de relation <b>linéaire</b> entre les deux variables</li>
							</ul>
						</div>	
					</section>
					<section>
						<h4 class="top_bar">Calcul direct du coefficient de corrélation (de Pearson)</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Soient deux variables $V_1$ et $V_2$</p>
							<p>Le coefficient de corrélation $r$ de $V_1$ et $V_2$ est la normalisation de la covariance par le produit des écart-types des variables</p>
							<p>$r = \frac{cov(V_1, V_2)}{\sigma_{V_1}\sigma_{V_2}}$</p>
							<p>La covariance est la <b>moyenne du produit des écarts à la moyenne</b></p>
							<p>$cov(V1,V2)=\mathbb{E}[(V1−\mathbb{E}[V1])(V2−\mathbb{E}[V2])]$</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Test de corrélation entre deux variables avec <span class="numpy text head active">scipy</span><span class="r text head inactive">R</span></h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Version plus complète : c’est un <b>test</b>, on a plusieurs indicateurs statistiques sur ce test, notamment la <b>p-value</b> et <b>l’intervalle de confiance</b></p>
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">from scipy.stats import pearsonr
result = pearsonr(df['petal length (cm)'], df['petal width (cm)'])
print(result, result.confidence_interval(0.95))</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">cor.test(iris$Petal.Length, iris$Petal.Width)</code></pre>

							<p></p>
							<pre class="numpy tab-content active"><code class="answer">PearsonRResult(statistic=0.962865431402796, pvalue=4.675003907328653e-86)
ConfidenceInterval(low=0.9490524593111143, high=0.972985317378797)</code></pre>
							<pre class="r tab-content inactive"><code class="answer">## 
##  Pearson's product-moment correlation
## 
## data:  iris$Petal.Length and iris$Petal.Width
## t = 43.387, df = 148, p-value < 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.9490525 0.9729853
## sample estimates:
##       cor 
## 0.9628654</code></pre>
							<p>Rappel : la p-value quantifie la <b>significativité</b> du test. En général, on considère le test significatif si elle est en dessous de 5%, soit 0.05.</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Test de corrélation entre deux variables avec <span class="numpy text head active">scipy</span><span class="r text head inactive">R</span></h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">df.corr(method='pearson')</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">cor(iris[,1:4])</code></pre>

							  <table border="1" class="numpy dataframe active">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th>sepal length (cm)</th>
									<th>sepal width (cm)</th>
									<th>petal length (cm)</th>
									<th>petal width (cm)</th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th>sepal length (cm)</th>
									<td>1.000000</td>
									<td>-0.117570</td>
									<td>0.871754</td>
									<td>0.817941</td>
								  </tr>
								  <tr class="tr1">
									<th>sepal width (cm)</th>
									<td>-0.117570</td>
									<td>1.000000</td>
									<td>-0.428440</td>
									<td>-0.366126</td>
								  </tr>
								  <tr class="tr2">
									<th>petal length (cm)</th>
									<td>0.871754</td>
									<td>-0.428440</td>
									<td>1.000000</td>
									<td>0.962865</td>
								  </tr>
								  <tr class="tr1">
									<th>petal width (cm)</th>
									<td>0.817941</td>
									<td>-0.366126</td>
									<td>0.962865</td>
									<td>1.000000</td>
								  </tr>
								</tbody>
							  </table>
							<pre class="r tab-content inactive"><code class="answer">##              Sepal.Length Sepal.Width Petal.Length Petal.Width
## Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
## Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
## Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
## Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000
</code></pre>
							<p>Présentation des corrélations entre les variables quantitatives d’un tableau, pour tous les couples de variables.</p>
							<p>La matrice de corrélation est symétrique, et sa diagonale est constituée de 1.</p>
						</div>
					</section>
					<section data-transition="slide-in fade-out">
						<h4 class="top_bar">Sensibilité aux outliers</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
					
					  		<!-- Python Code -->
					  		<pre class="tab-content numpy r active"><code class="language-python">X = [3,2,3,4,1,2,3,4,5,2,3,4,3]
Y = [1,2,2,2,3,3,3,3,3,4,4,4,5]
plt.figure(figsize=(16, 6))
plt.plot(X, Y, 'o')
plt.xlim(0, 16)
plt.ylim(0, 16)
plt.show()</code></pre>
							<p></p>
							<img class="numpy r img active" style="align-self: center;" src="img/images_bivariees/sensitiveOut1-1_python.png">
							<pre class="numpy r tab-content active"><code class="language-python">pearsonr(X, Y).statistic</code></pre>
							<pre class="numpy r tab-content active"><code class="answer">0.00</code></pre>
							
						</div>
					</section>
					<section  data-transition="slide-out fade-in">
						<h4 class="top_bar">Sensibilité aux outliers</h4>
						<div style="width:100%; height:90%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
					
					  		<!-- Python Code -->
					  		<pre class="tab-content numpy r active"><code class="language-python">X = [3,2,3,4,1,2,3,4,5,2,3,4,3, 15]
Y = [1,2,2,2,3,3,3,3,3,4,4,4,5, 15]
plt.figure(figsize=(16, 6))
plt.plot(X, Y, 'o')
plt.xlim(0, 16)
plt.ylim(0, 16)
plt.show()</code></pre>
							<p></p>
							<img class="numpy r img active" style="align-self: center;" src="img/images_bivariees/sensitiveOut2-1_python.png">
							<pre class="numpy r tab-content active"><code class="language-python">pearsonr(X, Y).statistic</code></pre>
							<pre class="numpy r tab-content active"><code class="answer">0.9052224371373307</code></pre>
							
						</div>
					</section>
					<section>
						<h4 class="top_bar">Sensibilité aux outliers</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p><b>Outlier</b> : observation “anormale”, par sa valeur extrême, comparée aux autres</p>
							<p>La corrélation et la régression linéaire sont très sensibles aux outliers.</p>
							<p>→ s’interroger sur la nécessité de nettoyer/filtrer les données et des conséquences</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Que faire lorsque la relation n’est pas linéaire ?</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Quand les deux variables semblent corrélées, de façon <b>monotone</b> mais <b>non linéaire</b>,</p>
							<p>→ <b>Coefficient de Spearman</b>, basé sur le rang des individus.</p>
							<p style="align-self: center;">$\rho = 1 - \frac{6\Sigma_{i=1}^n (rg(X_i) - rg(Y_i) )^2 }{n^3 - n}$</p>
							<p>avec :</p>
							<p>$rg(X_i)$ le rang de $X_i$ (le classement de sa valeur) dans la distribution de $X$</p>
							<p>$n$ le nombre d'individus</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Obtenir le coefficient de Spearman avec <span class="numpy text head active">scipy</span><span class="r text head inactive">R</span></h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<!-- Tab Navigation -->
							<div class="tabs">
								<button class="tab-button numpy active" onclick="showTab('numpy')">Python</button>
								<button class="tab-button r" onclick="showTab('r')">R</button>
							</div>
					
					  		<!-- Python Code -->
					  		<pre class="numpy tab-content active"><code class="language-python">from scipy.stats import spearmanr
spearmanr(df['sepal length (cm)'], df['sepal width (cm)'])</code></pre>
					  
					  		<!-- R Code -->
					  		<pre class="r tab-content inactive"><code class="language-r">cor.test(iris$Sepal.Length, iris$Sepal.Width, method="spearman", exact = FALSE)</code></pre>

							<p></p>
							<pre class="numpy tab-content active"><code class="answer">SignificanceResult(statistic=-0.166777658283235, pvalue=0.04136799424884587)</code></pre>
							<pre class="r tab-content inactive"><code class="answer">## 
##  Spearman's rank correlation rho
## 
## data:  iris$Sepal.Length and iris$Sepal.Width
## S = 656283, p-value = 0.04137
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.1667777</code></pre>
							<p class="r text inactive">l’argument exact doit être précisé en cas de valeurs ex aequo dans les données.</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Utilisation conjointe des coefficients de Pearson et Spearman</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>$r$ (Pearson) et $\rho$ (Spearman) sont deux moyens d'estimer la corrélation, lequel choisir ?</p>
							<p>si $r=\rho$ : on garde r (plus simple à interpréter)</p>
							<p>si $|r|<|\rho|$ : la relation est non-linéaire : prendre $\rho$</p>
							<p>si $|r|>|\rho|$ : il y a un biais, prendre $\rho$ (plus robuste)</p>
							<p>… et toujours <b>tracer le nuage de points</b> pour examiner la nature de la relation.</p>
						</div>
					</section>
				</section>
				<section>
					<section>
						<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
							<h4>“trucs” pour linéariser des relations non-linéaires</h4>
							<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Relation log-linéaire</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<img src="img/images_bivariees/loglin-1.png" style="align-self: center; width: 80%;">
							<p>Relation de $y = ax^b$</p>
							<p>Se linéarise par $ln(y) = b\times ln(x)+ln(a)$</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Relation géométrique (exponentielle)</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<img src="img/images_bivariees/expolin-1.png" style="align-self: center; width: 80%;">
							<p>Relation de $y = e^{ax+b}$</p>
							<p>Se linéarise par $ln(y) = ax+ln(b)$</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Relation logarithmique</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<img src="img/images_bivariees/logar-1.png" style="align-self: center; width: 80%;">
							<p>Relation de $y = a \times ln(x)+b$</p>
							<p>→ changement de variable</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Relation logistique</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<img src="img/images_bivariees/logistic-1.png" style="align-self: center; width: 80%;">
							<p>Relation de $y = y_{min} + \frac{y_{max} - y_{min}}{1 + e^{ax+b}}$</p>
							<p>Se linéarise par $ln(\frac{y_{max} - y}{y - y_{min}}) = ax+b$</p>
						</div>
					</section>
				</section>

				<section>
					<section>
						<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
							<h4>Liens entre deux variables qualitatives</h4>
							<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Représentation graphique</h4>
						<div style="width:100%; height:85%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Pour deux variables qualitatives, on ne peut pas produire de nuages de points, ni de droites de régression.</p>
							<p>→ On peut représenter la table de contingence (cf fonctions <span style="font-family: monospace;">statsmodels.graphics.mosaicplot.mosaic</span> et <span style="font-family: monospace;">pandas.crosstab</span>)</p>
							<img src="img/images_bivariees/mosaic-1.png" style="align-self: center; width: 60%;">
						</div>
					</section>
					<section>
						<h4 class="top_bar">Test statistique dit du “Chi 2” ou “Chi carré”</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Le test du $\chi^2$ est un test d’indépendance, il mesure l’<b>écart</b>, la différence, entre deux distributions de <b>variables qualitatives</b>.</p>
							<p>Il répond à la question : “Existe-t-il un lien statistique entre deux séries de valeurs qualitatives”</p>
							<p>(La réponse est de type OUI/NON , le $\chi^2$ ne donne pas l’<b>intensité</b> du lien)</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Test statistique dit du “Chi 2” ou “Chi carré”</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<ul>
								<li>Hypothèse nulle $H_0$ : les deux distributions sont indépendantes.</li>
								<li>«Faire le test» permet de conserver ou de rejeter cette hypothèse</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Principe du Chi 2</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<ul>
								<li>On génère une <b>population théorique</b> à laquelle on va comparer la <b>population observée</b> en considérant leurs <b>distributions</b>.</li>
								<li>Cette distribution théorique reflête ce qui se passerait si on suppose que $H_0$ est vraie.</li>
								<li>Avec cette comparaison, on pourra conserver ou de rejeter l'hypothèse nulle.</li>
							</ul>
							<p>La création de cette distribution se fait à partir du <b>tableau de contingence</b>.</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Tableau de contingence</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>C'est un tableau à double entrée qui croise deux <b>variables qualitatives</b>.<br>Dans une case on trouve l’<b>effectif</b> (= le nombre) des individus caractérisés par la conjonction des modalités en ligne et en colonnes.</p>
							<p>Exemple sur des formes géométriques de couleurs :</p>
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th><i>blanc</i></th>
									<th><i>noir</i></th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th><i>carré</i></th>
									<td>22</td>
									<td>12</td>
								  </tr>
								  <tr class="tr1">
									<th><i>rond</i></th>
									<td>10</td>
									<td>30</td>
								  </tr>
								  <tr class="tr2">
									<th><i>triangle</i></th>
									<td>26</td>
									<td>5</td>
								  </tr>
								</tbody>
							  </table>
							  <p class="numpy text active">Avec pandas : fonction <span style="font-family: monospace;">crosstab</span></p>
							  <p class="r text inactive">En R : fonction <span style="font-family: monospace;">table()</span></p>
						</div>
						
					</section>
					<section>
						<h4 class="top_bar">Construction de la distribution théorique</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>On commence par sommer les effectifs selon les modalités (en ligne et en colonne)</p>
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th><i>blanc</i></th>
									<th><i>noir</i></th>
									<th>total</th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th><i>carré</i></th>
									<td>22</td>
									<td>12</td>
									<td>34</td>
								  </tr>
								  <tr class="tr1">
									<th><i>rond</i></th>
									<td>10</td>
									<td>30</td>
									<td>40</td>
								  </tr>
								  <tr class="tr2">
									<th><i>triangle</i></th>
									<td>26</td>
									<td>5</td>
									<td>31</td>
								  </tr>
								  <tr class="tr1">
									<th>total</th>
									<td>58</td>
									<td>47</td>
									<td>105</td>
								  </tr>
								</tbody>
							  </table>
							<p>On appelle les sommes en lignes et en colonnes <b>sommes marginales</b>, elles sont mises dans les “marges” du tableau.</p>
						</div>
						
					</section>
					<section>
						<h4 class="top_bar">Construction de la distribution théorique</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>En divisant par la taille de la population, on obtient <b>les fréquences observées</b></p>
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th><i>blanc</i></th>
									<th><i>noir</i></th>
									<th>total</th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th><i>carré</i></th>
									<td>0.20952381</td>
									<td>0.11428571</td>
									<td>0.3238095</td>
								  </tr>
								  <tr class="tr1">
									<th><i>rond</i></th>
									<td>0.09523810</td>
									<td>0.28571429</td>
									<td>0.3809524</td>
								  </tr>
								  <tr class="tr2">
									<th><i>triangle</i></th>
									<td>0.24761905</td>
									<td>0.04761905</td>
									<td>0.2952381</td>
								  </tr>
								  <tr class="tr1">
									<th>total</th>
									<td>0.552381</td>
									<td>0.447619</td>
									<td>1</td>
								  </tr>
								</tbody>
							  </table>
							<p style="font-size: 20px;"> On obtient les <b>pourcentages de l’effectif</b> dans les cases du tableau.</p>
							<p style="font-size: 20px;"> C’est également la <b>probabilité</b> qu’un individu de la <b>population observée</b> soit caractérisé par les modalités en ligne et en colonne. </p>
						</div>
						
					</section>
					<section>
						<h4 class="top_bar">Construction de la distribution théorique</h4>
						<div style="width:100%; height:85%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th><i>blanc</i></th>
									<th><i>noir</i></th>
									<th>total</th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th><i>carré</i></th>
									<td>0.20952381</td>
									<td>0.11428571</td>
									<td><b>0.3238095</b></td>
								  </tr>
								  <tr class="tr1">
									<th><i>rond</i></th>
									<td>0.09523810</td>
									<td>0.28571429</td>
									<td><b>0.3809524</b></td>
								  </tr>
								  <tr class="tr2">
									<th><i>triangle</i></th>
									<td>0.24761905</td>
									<td>0.04761905</td>
									<td><b>0.2952381</b></td>
								  </tr>
								  <tr class="tr1">
									<th>total</th>
									<td><b>0.552381</b></td>
									<td><b>0.447619</b></td>
									<td><b>1</b></td>
								  </tr>
								</tbody>
							  </table>
							<p>De la même façon, les <b>fréquences marginales</b> (marges divisées par la taille de la pop.), donnent la <b>probabilité</b> d’observer un individu de la modalité correspondant à la ligne ou à la colonne considérée.</p>
							<p style="font-size: 20px;"> Exemple : dans cette population , j’ai 29.5% de chances de tirer un triangle, et 55% de chances de tirer une pièce blanche. </p>
						
						</div>
						
					</section>
					<section>
						<h4 class="top_bar">Construction de la distribution théorique</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Rappel : probabilité conjointe de deux événements <b>indépendants</b> :<br> $P(A \cap B) = P(A) \times P(B)$</p>
							<p>À partir des <b>fréquences marginales</b> précédentes, on obtient pour chaque couple de modalités, la probabilité <b>théorique</b>, celle qui suppose $H_0$, par un simple produit.</p>
							<p style="font-size: 20px;"> Exemple : Si $H_0$ est vraie, la probabilité d’observer un triangle noir est donnée par:</p>
							<p style="font-size: 20px;"> $P(triangle∩noir)=P(triangle)×P(noir)$</p>
							<p style="font-size: 20px;"> $P(triangle∩noir)=0.447619×0.2952381=0.1321542$</p>
							<p style="font-size: 20px;">La probabilité théorique d’observer un triangle noir est de 13,2%</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Construction de la distribution théorique</h4>
						<div style="width:100%; height:80%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>On crée un second tableau, dont chaque case vaut le produit des fréquences marginales calculées sur le tableau des observations.</p>
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th><i>blanc</i></th>
									<th><i>noir</i></th>
									<th>total</th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th><i>carré</i></th>
									<td>0.1788662</td>
									<td>0.1449433</td>
									<td>0.3238095</td>
								  </tr>
								  <tr class="tr1">
									<th><i>rond</i></th>
									<td>0.2104309</td>
									<td>0.1705215</td>
									<td>0.3809524</td>
								  </tr>
								  <tr class="tr2">
									<th><i>triangle</i></th>
									<td>0.1630839</td>
									<td>0.1321542</td>
									<td>0.2952381</td>
								  </tr>
								  <tr class="tr1">
									<th>total</th>
									<td>0.552381</td>
									<td>0.447619</td>
									<td>1</td>
								  </tr>
								</tbody>
							  </table>
							<p>C'est le tableau des <b>fréquences théoriques</b>.</p>
							
						</div>
						
					</section>
					<section>
						<h4 class="top_bar">Tableau des effectifs théoriques</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>On l’obtient en multipliant les fréquences théoriques par la taille de la population observée (ici 105)</p>
							<table border="1" class="dataframe">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th></th>
									<th><i>blanc</i></th>
									<th><i>noir</i></th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th><i>carré</i></th>
									<td>18.78095</td>
									<td>15.21905</td>
								  </tr>
								  <tr class="tr1">
									<th><i>rond</i></th>
									<td>22.09524</td>
									<td>17.90476</td>
								  </tr>
								  <tr class="tr2">
									<th><i>triangle</i></th>
									<td>17.12381</td>
									<td>13.87619</td>
								  </tr>
								</tbody>
							  </table>
							<p>N.B. Il n’est pas nécessaire d’arrondir les effectifs théoriques.</p>
						</div>
						
					</section>
					<section>
						<h4 class="top_bar">Calcul du Chi 2</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>C’est la somme, pour chaque case du tableau de contingence (i.e. pour chaque couple de modalités), des écarts carrés entre effectif observé et effectif théorique, divisés par l’effectif théorique.</p>
							<p>Soient $T^{obs}$ le tableau des effectifs observés, $T^{theo}$ le tableau des effectifs théoriques,</p>
							<p style="align-self: center;">$\chi^2 = \sum_{i, j}\frac{(T^{obs}_{i,j}−T^{theo}_{i,j})^2}{T^{theo}_{i,j}}$</p>
							<p>Ici : $\chi^2=26.30329$</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Interprétation du Chi 2</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Il faut comparer la valeur du $\chi^2$ calculée avec la valeur <b>critique</b> qu’on trouve dans une <b>table de loi du chi 2.</b></p>
							<p>C’est un tableau à double entrée : une <b>valeur de quantile</b>, et un <b>degré de liberté.</b></p>
							<p>On peut considérer que la valeur de quantile est le pourcentage d’erreur qu’on s’autorise de faire. On prend souvent <b>5%</b> : la colonne 1-0.05 = 0.95</p>
							<p>Le degré de liberté est obtenu en calculant la valeur :<br> $(nb_{lignes}−1)∗(nb_{colonnes}−1)$.</p>
							<p>Dans notre exemple , le degré de liberté est 2*1 = 2</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Table de loi du Chi 2</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Si $X$ suit une loi du $\chi^2$ de degré d, la valeur critique v est telle que : <br>$P(X < v)=1-\alpha$</p>
							<table border="1" class="dataframe" style="font-size: 17px;">
								<thead>
								  <tr style="text-align: right;" class="tr1">
									<th>$d \downarrow \alpha \rightarrow$</th>
									<th>0.95</th>
									<th>0.9</th>
									<th>0.8</th>
									<th>0.7</th>
									<th>0.5</th>
									<th>0.3</th>
									<th>0.2</th>
									<th>0.1</th>
									<th>0.05</th>
									<th>0.01</th>
									<th>0.001</th>
								  </tr>
								</thead>
								<tbody>
								  <tr class="tr2">
									<th>1</th>
									<td>0.003932</td>
									<td>0.015791</td>
									<td>0.064185</td>
									<td>0.148472</td>
									<td>0.454936</td>
									<td>1.074194</td>
									<td>1.642374</td>
									<td>2.705543</td>
									<td>3.841459</td>
									<td>6.634897</td>
									<td>10.827566</td>
								  </tr>
								  <tr class="tr1">
									<th>2</th>
									<td>0.102587</td>
									<td>0.210721</td>
									<td>0.446287</td>
									<td>0.713350</td>
									<td>1.386294</td>
									<td>2.407946</td>
									<td>3.218876</td>
									<td>4.605170</td>
									<td>5.991465</td>
									<td>9.210340</td>
									<td>13.815511</td>
								  </tr>
								  <tr class="tr2">
									<th>3</th>
									<td>0.351846</td>
									<td>0.584374</td>
									<td>1.005174</td>
									<td>1.423652</td>
									<td>2.365974</td>
									<td>3.664871</td>
									<td>4.641628</td>
									<td>6.251389</td>
									<td>7.814728</td>
									<td>11.344867</td>
									<td>16.266236</td>
								  </tr>
								  <tr class="tr1">
									<th>4</th>
									<td>0.710723</td>
									<td>1.063623</td>
									<td>1.648777</td>
									<td>2.194698</td>
									<td>3.356694</td>
									<td>4.878433</td>
									<td>5.988617</td>
									<td>7.779440</td>
									<td>9.487729</td>
									<td>13.276704</td>
									<td>18.466827</td>
								  </tr>
								  <tr class="tr2">
									<th>5</th>
									<td>1.145476</td>
									<td>1.610308</td>
									<td>2.342534</td>
									<td>2.999908</td>
									<td>4.351460</td>
									<td>6.064430</td>
									<td>7.289276</td>
									<td>9.236357</td>
									<td>11.070498</td>
									<td>15.086272</td>
									<td>20.515006</td>
								  </tr>
								  <tr class="tr1">
									<th>6</th>
									<td>1.635383</td>
									<td>2.204131</td>
									<td>3.070088</td>
									<td>3.827552</td>
									<td>5.348121</td>
									<td>7.231135</td>
									<td>8.558060</td>
									<td>10.644641</td>
									<td>12.591587</td>
									<td>16.811894</td>
									<td>22.457744</td>
								  </tr>
								  <tr class="tr2">
									<th>7</th>
									<td>2.167350</td>
									<td>2.833107</td>
									<td>3.822322</td>
									<td>4.671330</td>
									<td>6.345811</td>
									<td>8.383431</td>
									<td>9.803250</td>
									<td>12.017037</td>
									<td>14.067140</td>
									<td>18.475307</td>
									<td>24.321886</td>
								  </tr>
								  <tr class="tr1">
									<th>8</th>
									<td>2.732637</td>
									<td>3.489539</td>
									<td>4.593574</td>
									<td>5.527422</td>
									<td>7.344121</td>
									<td>9.524458</td>
									<td>11.030091</td>
									<td>13.361566</td>
									<td>15.507313</td>
									<td>20.090235</td>
									<td>26.124482</td>
								  </tr>
								  <tr class="tr2">
									<th>9</th>
									<td>3.325113</td>
									<td>4.168159</td>
									<td>5.380053</td>
									<td>6.393306</td>
									<td>8.342833</td>
									<td>10.656372</td>
									<td>12.242145</td>
									<td>14.683657</td>
									<td>16.918978</td>
									<td>21.665994</td>
									<td>27.877165</td>
								  </tr>
								  <tr class="tr1">
									<th>10</th>
									<td>3.940299</td>
									<td>4.865182</td>
									<td>6.179079</td>
									<td>7.267218</td>
									<td>9.341818</td>
									<td>11.780723</td>
									<td>13.441958</td>
									<td>15.987179</td>
									<td>18.307038</td>
									<td>23.209251</td>
									<td>29.588298</td>
								  </tr>
								  <tr class="tr2">
									<th>11</th>
									<td>4.574813</td>
									<td>5.577785</td>
									<td>6.988674</td>
									<td>8.147868</td>
									<td>10.340998</td>
									<td>12.898668</td>
									<td>14.631421</td>
									<td>17.275009</td>
									<td>19.675138</td>
									<td>24.724970</td>
									<td>31.264134</td>
								  </tr>
								  <tr class="tr1">
									<th>12</th>
									<td>5.226029</td>
									<td>6.303796</td>
									<td>7.807328</td>
									<td>9.034277</td>
									<td>11.340322</td>
									<td>14.011100</td>
									<td>15.811986</td>
									<td>18.549348</td>
									<td>21.026070</td>
									<td>26.216967</td>
									<td>32.909490</td>
								  </tr>
								  <tr class="tr2">
									<th>13</th>
									<td>5.891864</td>
									<td>7.041505</td>
									<td>8.633861</td>
									<td>9.925682</td>
									<td>12.339756</td>
									<td>15.118722</td>
									<td>16.984797</td>
									<td>19.811929</td>
									<td>22.362032</td>
									<td>27.688250</td>
									<td>34.528179</td>
								  </tr>
								  <tr class="tr1">
									<th>14</th>
									<td>6.570631</td>
									<td>7.789534</td>
									<td>9.467328</td>
									<td>10.821478</td>
									<td>13.339274</td>
									<td>16.222099</td>
									<td>18.150771</td>
									<td>21.064144</td>
									<td>23.684791</td>
									<td>29.141238</td>
									<td>36.123274</td>
								  </tr>
								</tbody>
							  </table>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Interprétation du Chi 2</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>D’après le tableau de la loi du $\chi^2$, la valeur critique pour un test avec 5% de chances de se tromper est un degré de liberté de 2 vaut 5.991.</b></p>
							<p>Si la valeur calculée du $\chi^2$ est <b>supérieure</b> à la valeur critique, on <b>rejette</b> $H_0$</b></p>
							<p>Pour notre exemple: On rejette $H_0$, i.e. les deux variables sont <b>dépendantes</b>, car $\chi^2≈26>5.991$</p>
							<p>Interprétation: «la forme est liée à la couleur dans cette population, nous pouvons l’affirmer avec un risque d’erreur d’au moins 5%»</p>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Les étapes du Chi 2</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<ul>
								<li>Tableau de contingence</li>
								<li>Sommes marginales<ul>
									<li>Calcul des fréquences observées</li>
									<li>Calcul des fréquences théoriques</li>
								</ul></li>
								<li>Tableau d’effectifs théoriques</li>
								<li>Calcul de la valeur du test</li>
								<li>Comparaison avec les valeurs de la table de Chi 2</li>
							</ul>
						</div>
					</section>
				</section>

				<section>
					<section>
						<div style="width:100%; height:100%; display: flex; flex-direction:column; justify-content: center;">
							<h4>Lien entre une variable qualitative et une variable quantitative.</h4>
							<div style="width: 100%; height: 1px; background-color: #97bf11"></div>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Représentation graphique</h4>
						<div style="width:100%; height:75%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Pas de moyen <b>simple</b> de calculer le lien entre une variable qualitative et une variable quantitative.</p>
							<ul style="align-self: center;">
								<li>corrélation de rang</li>
								<li>régression logistique</li>
								<li>analyse de la variance (ANOVA)</li>
							</ul>
							<p>⟹ Alors on fait un graphique !</p>
							<p>La variable qualitative sert de <b>catégorie</b>, on fait varier la représentation graphique de la variable quantitative suivant cette catégorie.</p>
							<p>2 possibilités :</p>
							<ul style="align-self: center;">
								<li>boîtes à moustaches</li>
								<li>superposition d’histogrammes / densités</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 class="top_bar">Boxplot par catégories</h4>
						<div style="width:100%; height:95%; display: flex; flex-direction:column; justify-content: center; align-items:start; text-align: justify;">
							<p>Principe : on trace un boxplot par modalité de la variable qualitative</p>
							<p>E.g. : consommation de véhicules par type (dataset mpg de R)</p>
							<img src="img/images_bivariees/unnamed-chunk-2-1.png" width="100%">
						</div>
					</section>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				slideNumber: true,
				center: true,
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
			});
		</script>
		<!-- Add JavaScript for tab functionality -->
		<script>
			function showTab(tabId) {
			// Hide all tab content
			document.querySelectorAll('section').forEach(section => {
				if(section.querySelectorAll("."+tabId).length>0){
					section.querySelectorAll('.tab-content').forEach(content => {
						content.classList.remove('active');
						content.classList.add('inactive')
					});
					section.querySelectorAll('.active').forEach(content => {
						content.classList.remove('active');
						content.classList.add('inactive')
					});
				
					// Deactivate all tab buttons
					section.querySelectorAll('.tab-button').forEach(button => {
						button.classList.remove('active');
					});
				
					// Show the selected tab content
					section.querySelectorAll("."+tabId).forEach(content => {
						content.classList.remove('inactive');
						content.classList.add('active');
					});
				}
			})
			
			

			}
		</script>
	</body>
</html>
